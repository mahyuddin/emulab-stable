#
# EMULAB-COPYRIGHT
# Copyright (c) 2000-2002 University of Utah and the Flux Group.
# All rights reserved.
#

SRCDIR		= @srcdir@
TESTBED_SRCDIR	= @top_srcdir@
OBJDIR		= ../..
SUBDIR		= event/nsetrafgen
INSTALL_SUPDIR	= /usr/testbed/sup/sup/FBSD45-STD/root
INSTALL_FILES	= $(SRCDIR)/nseinput.tcl $(SRCDIR)/startnse
INSTALL_NSE     = $(SRCDIR)/nse

include $(OBJDIR)/Makeconf

all: msg

msg:
	@echo ""
	@echo -n "WARNING! You must first do a \"make buildnse\" in $(SRCDIR) "
	@echo "if $(SRCDIR)/nse is not built"
	@echo "WARNING! It takes about 15 minutes for buildnse"
	@echo ""

include $(TESTBED_SRCDIR)/GNUmakerules

buildnse:
	cd $(SRCDIR); $(SRCDIR)/nse-install

sup-install:
	cp -p $(INSTALL_FILES) $(INSTALL_SUPDIR)$(CLIENT_BINDIR)
	cp -p $(INSTALL_NSE) $(INSTALL_SUPDIR)/usr/local/bin

client-install:
	cp -p $(INSTALL_FILES) $(DESTDIR)$(CLIENT_BINDIR)
	if [ -x $(INSTALL_NSE) ]; then \
	    $(INSTALL) -m 755 -o root -g wheel -d $(DESTDIR)/usr/local/bin; \
	    cp -p $(INSTALL_NSE) $(DESTDIR)/usr/local/bin; \
	fi

clean:
	/bin/rm -f $(INSTALL_NSE)
