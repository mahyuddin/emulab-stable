#!/usr/bin/perl -w
#
# EMULAB-COPYRIGHT
# Copyright (c) 2000-2002 University of Utah and the Flux Group.
# All rights reserved.
#
use English;

# Drag in path stuff so we can find emulab stuff.
BEGIN { require "/etc/emulab/paths.pm"; import emulabpaths; }

#
# Load the OS independent support library. It will load the OS dependent
# library and initialize itself. 
# 
use libsetup;

#
# Really comes from libloc.
#
my $MAPFILE = $libsetup::TMDELMAP;

if (! -s $MAPFILE) {
    exit(0);
}
print "Starting Delay Agent ...\n";

#
# We use the tmcc to figure out where the Testbed Event Daemon is running.
# Don't worry about the port for now.
#
my ($bossname) = split(" ", `tmcc bossinfo`);

system("delay-agent -s $bossname -d -f $MAPFILE &");
exit($? >> 0);
