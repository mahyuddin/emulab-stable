#!/usr/bin/perl -wT
use English;

push(@INC, "/etc/testbed");
require setuplib;

#
# Untaint path
#
$ENV{'PATH'} = '/bin:/sbin:/usr/bin:/usr/local/bin:/etc/rc.d/testbed';
delete @ENV{'IFS', 'CDPATH', 'ENV', 'BASH_ENV'};

#
# First clean up the node.
#
cleanup_node();

#
# Inform the master that we have rebooted.
#
inform_reboot();

#
# Check allocation. Exit now if not allocated.
#
if (! check_status()) {
    exit(0);
}

#
# Setup a nicknames file. 
#
create_nicknames();

#
# Mount the project directory.
#
mount_projdir();

#
# Okay, lets find out about interfaces.
#
doifconfig();

#
# Host names configuration (/etc/hosts). 
#
dohostnames();

#
# Check for delay config.
#
dodelays();

#
# Do account stuff.
# 
doaccounts();

#
# RPMS
# 
dorpms();

#
# Experiment startup Command.
#
dostartupcmd();

exit(0);
