#
# EMULAB-COPYRIGHT
# Copyright (c) 2000-2002 University of Utah and the Flux Group.
# All rights reserved.
#

SRCDIR		= @srcdir@
TESTBED_SRCDIR	= @top_srcdir@
OBJDIR		= ..
SUBDIR		= assign

#
# Support for optional assign binary to avoid LEDA restrictions
#
ASSIGNBINARY	= @ASSIGN@

include $(OBJDIR)/Makeconf

all: assign 

include $(TESTBED_SRCDIR)/GNUmakerules

LEDA=@LEDA@

OBJS=score.o parse_top.o parse_ptop.o config.o pclass.o vclass.o
LIBS+=-L${LEDA} -lD3 -lW -lP -lG -lL -L/usr/X11R6/lib -lX11 -lm -L.
LDFLAGS+= -O3
CXXFLAGS = -I${LEDA}/incl

# Pick one of the following:
CXXFLAGS += -Wall -O3 
#CXXFLAGS += -O0 -g -Wall -DVERBOSE
#CXXFLAGS += -O0 -g -Wall -DVERBOSE -DSCORE_DEBUG -DPCLASS_DEBUG
#CXXFLAGS += -O0 -g -Wall -DVERBOSE -DSCORE_DEBUG -DPCLASS_DEBUG -DPCLASS_DEBUG_MORE
#CXXFLAGS += -O0 -g -Wall -DVERBOSE -DSCORE_DEBUG -DSCORE_DEBUG_MORE -DPCLASS_DEBUG -DPCLASS_DEBUG_MORE

#CXXFLAGS += -DSTATS

# If you're looking to turn on or off USE_OPTIMAL, its now a cmdline
# option. Use OP={0,1} on the command line at run time... :)

DEPLIBS=$(OBJS)

ifdef ASSIGNBINARY
assign:	${ASSIGNBINARY}
	rm -f assign
	cp $< assign
else
assign: ${DEPLIBS} ${OBJS} assign.o
	${CXX} assign.o -o assign ${LIBS} $(OBJS) ${LDFLAGS}
endif

install: $(INSTALL_LIBEXECDIR)/assign 

clean:
	/bin/rm -f *.o assign 
