<!--
   EMULAB-COPYRIGHT
   Copyright (c) 2000-2005 University of Utah and the Flux Group.
   All rights reserved.
  -->
<center>
<h2>RDP to Node</h2>
</center>

<p>  This is used to connect to a Windows node in your experiment and get a
remote Windows Desktop using the Remote Desktop Protocol (RDP).  </p>

<p>First, you need an RDP client program installed on your computer:  </p>

<ul>

  <li> There is a nice open-source RDP client for Unix and Linux at 
       <a href="http://www.rdesktop.org/">www.rdesktop.org</a>.
       It may already be installed on your computer: to find out, try:
       <pre>which rdesktop</pre></li>

  <li> There is a Microsoft RDC (Remote Desktop Client) installed in
       Windows XP.  You can also install it from a Windows XP
       installation CD onto Windows 95 through 2000.  For details, see
       <a href="http://www.chicagotech.net/rdesktop.htm#How%20to%20install%20Remote%20Desktop%20Connection%20client">
       How to install Remote Desktop Connection client</a>.

</ul>

<p>Clicking "RDP to Node" in the Node Options page will send your
browser a MimeType "text/x-testbed-rdp" file with extension ".tbrdp". <ul>
<li> In FreeBSD or Linux, you
     can save the file and pass it as an argument to
     <code>rdp-mime.pl</code> or associate it with <code>rdp-mime.pl</code>
     in your web browser. You can download the <code>rdp-mime.pl </code><a
     href="rdp-mime.pl">Perl program here</a>.</li> <br>
<li> In Windows XP or 2000, you have the same choice to save and open the
     .tbrdp file with a script, or associate it with the script in the browser
     so you can just click.  See the installation directions <a
     href="#windows_install">below</a>.</li>
</ul> 
</p>


<p>You can specify any display resolution (rdesktop window size) you
want in the rdp-mime.pl script.  The default is 1280x1024 but it
doesn't have to be one of the "normal" ones.  And you can switch back
and forth between sizes by just starting a new rdesktop with different
arguments and "grabbing" the rlogin session away from the previous
one.  </p>

<p>But once an rdesktop is started up, its display resolution is
fixed.  If you make it smaller than the previous one, Windows will
push your windows around to fit in the smaller space.  </p>

<p>
<font size='+1'><b>Instructions for Linux/FreeBSD:</b></font>
<ul>
<li>Move the <code>rdp-mime.pl</code> script into 
    a directory of your choice (<code>/usr/local/bin</code>, 
    or <code>~/bin</code> are two good places.)</li>
<li>Set up your browser to handle MIME type "text/x-testbed-rdp"
    as outlined below.</li>
<li>In the Web Interface Node view, click on the "RDP to Node" link.</li>
<li>If your browser is properly configured to use <code>rdp-mime.pl</code>,
    a new xterm window with an rdp session open to your node
    should emerge.</li>
</ul>
</li>

<ul>
  <li><font size='+1'><b>Linux/FreeBSD and Netscape 4.7:</b></font>
  <ul>
  <li>Choose <code>preferences</code> from the <code>edit</code> menu.</li>
  <li>Select <code>Navigator</code>, then <code>Applications</code> under
      it.</li>
  <li>Click the <code>New...</code> button.</li>
  <li>In the <code>MIMEType</code> box, type <code>text/x-testbed-rdp</code>
      </li>
  <li>In the <code>Suffixes</code> box, type <code>tbrdp</code></li>
  <li>Choose <code>Application</code> in the <code>Handled by</code>
      box</li>
  <li>Next to <code>Application</code>, either type the path to the
      <code>rdp-mime.pl</code> script, or use <code>Choose...</code> to find
      it.</li>
  <li>Now, <b>be sure to</b> put a space, then <code>%s</code> after the
      path to the application in the box. This tells netscape to actually
      pass the control file into rdp-mime.pl (Mozilla does not require this;
      see below.)</li>
  <li>Click <code>OK</code>, then <code>OK</code> again.</li>
  </ul> 
  </li>

  <li><font size='+1'><b>Linux/FreeBSD and Mozilla:</b></font>
  <ul>
  <li>Choose <code>preferences</code> from the <code>edit</code> menu.</li>
  <li>Select <code>Navigator</code>, then <code>Helper Applications</code> 
      under it.</li>
  <li>Click the <code>New Type...</code> button.</li>
  <li>In the <code>MIMEType</code> box, 
      type <code>text/x-testbed-rdp</code></li>
  <li>In the <code>File extension</code> box, type <code>tbrdp</code></li>
  <li>For <code>Application to use</code>, either type the path to the
      <code>rdp-mime.pl</code> script, or use <code>Choose...</code> to find
      it.</li>
  <li>In Mozilla do <b>not</b> add a <code>%s</code>.</li>
  <li>Click <code>OK</code>, then <code>OK</code> again.</li>
  </ul>
  </li>

  <li><font size='+1'><b>Linux/FreeBSD and Firefox:</b></font>
      <ul>
          <li>Click on a node RDP icon in the Node Options page.
	      An <code>Opening...</code> dialog will appear.</li>

	  <li>Go to the <code>Open with</code> line and select the radio
	      button.</li> 
	  <li><code>Browse...</code> to the <code>rdp-mime.pl</code> script
	      you installed above.</li> 
	  <li>Click <code>OK</code>.</li>
	  <li>Once this is working, you can click the
	      <code>Do this automatically</code> check box.</li>
      </ul>
  </li>

  <li><font size='+1'><b>Linux/FreeBSD and Opera:</b></font>
  <ul>
  <li>Choose <code>preferences</code> from the <code>File</code> menu.</li>
  <li>Select <code>Applications</code>, then <code>File Types</code> 
      under it.</li>
  <li>Click the <code>New ...</code> button.</li>
  <li>In the <code>MIMEType</code> box, 
      type <code>text/x-testbed-rdp</code></li>
  <li>In the <code>File extension</code> box, type <code>tbrdp</code></li>
  <li>For <code>Open with other application</code>, either type the path to 
      the <code>rdp-mime.pl</code> script, or use <code>Choose...</code> to 
      find it.</li>
  <li>In Opera do <b>not</b> add a <code>%s</code>.</li>
  <li>Click <code>OK</code>, then <code>OK</code> again.</li>
  </ul>
  </li>
</ul>

<font size='+1'><b><a name="windows_install"></a>Instructions for Windows:</b></font>
<ul>
  <li>For Windows XP or 2000, you can download the Emulab Perl programs and wrapper 
      programs in a <a href="emulab-mime-winxp.zip">zip file here</a>.  
      It contains {ssh,rdp}-mime-winxp.{c,exe,pl} .
      The C programs are tiny wrappers which just exec the perl scripts.</li>
  <li><font size='+1'><b>Software dependencies:</b></font></li>
  <ul>
     <li>This depends on having least a basic installation of 
   	 <a href="www.cygwin.com">Cygwin</a> as well.</li>
     <li>You can select Perl within Cygwin, or install another 
   	 <a href="http://www.perl.org/">Perl port</a>.</li>
  </ul>
  <li>Unpack the Emulab exe's and pl's into an install directory of your
      choice.  The Cygwin bin directory is a good choice, and defaults to
      <code>C:\cygwin\bin</code>.</li>
  <li>You can copy putty.exe into that directory as well, or make sure the
      system path contains the PuTTY install directory.</li>
  <li>Make sure that the install directory, and also the Perl directory, are on
      your Windows system path, not just your Cygwin shell path.  Look in
      <code>Control Panel / System / Advanced / Environment Variables</code>
      and double-click on <code>Path</code> in the lower <code>System Variables</code>
      pane to edit.</li>
  <li><font size='+1'><b>Windows and Mozilla/Firefox:</b></font>
      To associate the handler with the .tbrdp file type in Mozilla/Firefox:
      <ul>
          <li>Click on a node RDP icon in the Node Options page.</li>
	  <li>Go to the <code>Open with</code> line and select 
	      <code>Other...</code> from the pull-down list.</li>
	  <li>Browse to the rdp-mime-winxp.exe application you installed 
	      above.</li>
	  <li>Once this is working, you can click the
	      <code>Do this automatically</code> check box.</li>
      </ul>
  <li><font size='+1'><b>Windows and Internet Explorer:</b></font>
      To associate the handler with the .tbrdp file type in Windows:
      <ul>
          <li>IE associations come from Windows itself.  Until that is set up, 
	      IE will just say <code>Unknown file type</code> and offer to save 
	      the .tbrdp file.</li>
	  <li>You can install the file associations in the registry in
	      one click by downloading and executing <a
	      href="emulab-mime-winxp.reg">this registry file</a>.
	      (Assumes programs installed in <code>C:\cygwin\bin</code> as above.)
	      Otherwise, go through the following steps.</li>
	  <li>Select <code>Save</code> and you will get a 
	      </code>Download complete</code> dialog with an 
	      </code>Open</code> button.  Click it.</li>
	  <li>Click <code>Select the program from a list</code>
	      and <code>OK</code>.</li>
	  <li>Finally, you get an <code>Open with</code> dialog with a 
	      <code>Browse...</code> button.</li>
	  <li>Browse to the rdp-mime-winxp.exe application you installed above
	      and click <code>Open</code>.</li>
          <li>Now you are back on the <code>Open with</code> dialog and 
	      <code>rdp-mime-winxp</code> is on the <code>Programs</code> list.
	      You could enter a description of "Emulab RDP connector".</li>
          <li>Make sure "<code>Always use the selected program to open this kind 
	      of file</code>" is on.</li>
      </ul></li>
</ul>
</p>
