<!--
   EMULAB-COPYRIGHT
   Copyright (c) 2000-2003 University of Utah and the Flux Group.
   All rights reserved.
  -->
<a name="top"></a>
<center>
<h1>Node Use Policies</h1>
</center>

<ul>
<li><a href="#summary">
What are your policies?</a>
<li><a href="#active">
What is "active use"?</a>
<li><a href="#idleness">
When is an experiment considered idle?</a>
<li><a href="#swapping">
What is "swapping"?</a>
<li><a href="#idleswap">
What is an "Idle-Swap"?</a>
<li><a href="#autoswap">
What is an "Auto-Swap"?</a>
<li><a href="#idle">
How long is too long for a node to be idle?</a>
<li><a href="#state">
What is "node state"?</a>
<li><a href="#email">
I just received an email asking me to swap or terminate my
experiment.</a>
<li><a href="#swapped">
Someone swapped my experiment!</a>
</ul>


<a name="summary"></a>
<h3>What are your policies?</h3>

<p>
As a courtesy to other experimenters, we ask that experiments be
swapped out or terminated when they are no longer in active use. There
are a limited number of nodes available, and node reservations are
exclusive, so it is important to free nodes that will be idle so that
others may use them. By way of summary, our policy is that experiments
should be swapped out when they are not in use. In general, if they
are idle for several hours, we will send you mail about it and/or
swap out the experiment for you. The actual grace period will differ
depending on the size of the experiment and other factors. If you mark
your experiment "unswappable" at creation time, we will contact you
before swapping it, since local node state will be lost on
swapout. Please see full details below.
</p>

<a name="active"></a>
<h3>What is "active use"?</h3>

<p>
A node or experiment that is being actively used will be doing
something related to your experiment. In almost all cases, someone
will either be logged into it using it interactively, or some program
will be running, sending and receiving packets, and performing the
operations necessary to carry out the experiment.
</p>

<a name="idleness"></a>
<h3>When is an experiment considered idle?</h3>

<p>
Your experiment will be considered idle if it has no mesurable 
activity for a significant period of time (a few hours). 
We detect the following types of activity:
<ul>
<li>Any Network activity on the experimental network
<li>Substantial activity on the control network
<li>TTY/console activity on nodes
<li>High CPU activity on nodes
<li>Certain external events, like rebooting a node with <tt>node_reboot</tt>
</ul>
If your experiment's activity falls outside these measurable types 
of activity, please be sure to let us know when you create your 
experiment, or you may be swapped out unexpectedly.
</p>

<a name="swapping"></a>
<h3>What is "swapping"?</h3>

<p>
Swapping is the process of instantiating your experiment,
i.e. allocating nodes, configuring links, etc. It also refers 
to the reverse process, where nodes are released. These are
called "swapping in" and "swapping out" respectively. See also
the <A href="docwrapper.php3?docname=faq.html#UTT-Swapping">
What is Swapping?</a> question on our FAQ.
</p>

<a name="idleswap"></a>
<h3>What is an "Idle-Swap"?</h3>

<p>
An "Idle-Swap" is when Emulab or its administrators swap your 
experiment out for you because it was idle for too long. 
Experiments typically don't get idle-swapped until they've been 
idle for several hours. We try to contact the experiment creator
before swapping, unless they've already given us permission to 
swap the experiment when idle.
</p>

<a name="autoswap"></a>
<h3>What is an "Auto-Swap"?</h3>

<p>
An "Auto-Swap" is when Emulab or its administrators swap your
experiment out because it was swapped in for longer than its specified
time limit. Emulab allows users to schedule experiment swapouts, to
aid experimenters in releasing nodes in a timely manner.  For
instance, if you plan to use your experiment throughout an 8 hour work
day, you can schedule a swapout for 8 hours after it is swapped
in. That way, if you forget to swap out before leaving for the day, it
will automatically be taken care of for you, without leaving the nodes
reserved and idle for several hours before being idle-swapped. For
automated experiments, it can also help by letting you schedule an
auto-swap for just after the maximum amount of time your experiment
should last.  You will typically receive a warning message about any
upcoming auto-swaps about an hour before they occur, to give you a
chance to readjust the timing for your auto-swap.
</p>

<a name="idle"></a>
<h3>How long is too long for a node to be idle?</h3>

<p>
Ideally, an experiment should be used nearly continuously from start
to finish of the experiment, then swapped out or terminated. However,
this isn't always possible. In general, if your experiment will most
likely be idle for 2 hours or more, it should be swapped out. This is
especially true at night (in U.S. timezones) and on weekends. Many
experimenters take advantage of lower demand during evenings and
weekends to run their large-scale (50-150 node) tests. If your
experiment uses 10 nodes or more, it is even more important to release
your nodes as soon as possible. Swapin and swapout only take a few
minutes (typically 3-5 for swapin, and less than 1 for swapout), so
you won't lose much time by doing it.
</p>

<p>
Sometimes an experiment will run long enough that you cannot be online
to terminate it. For example, if the experiment completes in the
middle of the night. We provide two mechanisms to assist you in
terminating your experiment and releasing nodes in a timely
manner. The first is the <a href="tutorial/tutorial.php3#BatchMode">
<em>batch system</em></a> and the other is
<a href="tutorial/tutorial.php3#Halting"><em>scheduled
termination</em></a>. Please consult the 
<a href = "tutorial/tutorial.php3">Emulab Tutorial</a> for information
on these and other topics.
</p>

<a name="state"></a>
<h3>What is "node state"?</h3>

<p>
Some experiments have state that is stored exclusively on the nodes
themselves, saved to the local hard drive. This is state that is not
in your NS file and files it references, and which is not preserved in
our database across swapin/swapout. This is state you add to your
machines "by hand" after Emulab sets up your experiment, like files
you add or modify on filesystems local to test nodes. Local node state
does not include any data you store in /users or /proj, since they are
saved on a fileserver, and not on the local nodes. 
</p>

<p>
Most experiments don't have any local node state, and can be swapped
out and in without losing any information. This is highly recommended,
since it is more courteous to other experimenters. It allows you to
easily free up your nodes on request without losing any of the work
you have done on your experiment. Please make your experiments adhere
to this guideline whenever possible.
</p>

<p>
Wherever possible it is discouraged to have local node state, since
swapping out causes this data to be lost. An experiment that needs
local state should be marked "unswappable" when you create it. If you
must have node state, you can save it before you swap out by creating
a disk image of the node in question, and later reloading it to a new
node after you swap in again. Disk images in effect create a "custom
OS" that can be loaded automatically based on your NS file. More
information about disk images can be found on our <a
href="https://www.emulab.net/newimageid_ez.php3"> Disk Image
page</a> (you must be logged in to use it). We are currently working
on a system that will allow you to save disk images from all the nodes
in your experiment at swapout time, and reload them automatically when
you swap back in.
</p>

<a name="email"></a>
<h3>I just received an email asking me to swap or terminate my
experiment.</h3>
<p>
Emulab has a system for detecting node use, to help achieve more
efficient and fair use of Emulab's limited resources. This system
sends email messages to experiment leaders whose experiments have been
idle for several hours. If you get a message like this, your
experiment has been inactive for too long and should free up the nodes
it has allocated. If the experiment continues to be idle, more
reminders may be sent, and soon 
your project leader will be one of the recipients. 
After you have been notified, your experiment may be swapped at any 
time, depending on current demand for nodes, and other factors.
</p>

<p>
If you feel you received the message in error, please respond to <a
href="mailto:testbed-ops@flux.cs.utah.edu"> Testbed Operations
(testbed-ops@flux.cs.utah.edu)</a> as soon as possible, describing how
you have used your node in the last few hours. There are some types of
activity that are difficult to accurately detect, so we'd like to know
how we can improve our activity detection system. Above all, <b>do not
ignore these messages</b>. If you get several reminders and don't
respond, your experiment may be swapped out, potentially causing loss
of some of your work (see "node state" above). If there is a reason
you need to keep your experiment running <b>tell us</b> so we don't
inadvertently cause problems for you.
</p>

<a name="swapped"></a>
<h3>Someone swapped my experiment!</h3>
<p>
As described above, we will typically try to contact you about your
idle experiment before we swap it out. However, if the experiment has
been idle for several hours, we may swap it out for you unless you marked
it as "unswappable" when you created your experiment. Because of this,
it is critical that you keep in close contact with us about an
experiment that we may perceive as idle if you want to avoid any loss
of your work.
</p>
<p>
<a href="#top"> Back to top of page</a>
</p>

