----------------------------------------------------------------------

Conventions:

Any line beginning with # should be ignored as a comment.

Lists are always space separated.

A labelvalue is either:

label: value

OR

label=
multi-line value
.
.
.
=

----------------------------------------------------------------------

Basic Layout:

The file is divided into a hierarchical array of sections bracketed with:

START <section>
END <section>

Sections can be within sections and no order is imposed.

----------------------------------------------------------------------

Sections:

Topology: describes the base desired topology of the network.  

START topology
START nodes
# <node> <type> <links> 
# <node> refers to a string name that should be easily mappable
# to a physical machine (IP address, hostname, etc.)
# <type> is usually "pc", "dnard", or "delay"
# <links> is a space separated list of link ids
END nodes
START links
# <link> <src> <srcport> <dst> <dstport> <bandwidth_min> <bandwidth_max> <delay_min> <delay_max> <loss_rate>
# <link> is a unique link identifier.
# <src> and <dst> are node identifiers (or lans).
# <srcport> and <dstport> are integers.  A port of -1 indicates that
# this information is N/A or unknown.
# <bandwidth*> and <delay*> are optional.  They specify the boundaries of 
# bandwidth and delay.
# <loss_rate> is the rate of loss.  If omitted assumed to be 0.
END links
START lans
# <lan> "<nodes>" <bw> <delay> <links>
# <lan> is a lan identifier and also acts as a node identifier for the
# purposes of links.
# <nodes> is a space seperated list of nodes
# <bw> is the bandwidth of the LAN
# <delay> is the latency of the LAN
END lans
END topology


Virtual: Describes the mapping of virtual objects to physical objects

START virtual
START nodes
# <virtual node> <physical node>
# <virtual node> is a string identifying a node in the virtual network.
# <physical node> is a node identifier
END nodes
START links
# <virtual link> <physical links>
# <physical links> is a space separated list of physical links making
# up the virtual link.
END links
START lans
# <virtual lan> <physical nodes>
END lans
END virtual

NodeInfo: Describes each physical node in more detail. 

START nodeinfo
# This is a number of records of the form:
# node <node>
# labelvalue
# . 
# . 
# .
# end
# 
# Existing labels are:
# type - the type of the node
# events - a multi-line field describing events in the form
#    <time> <type> <parameters>
# links - redundant with topology
# delays - multiline spec of delay forwarding of the format:
#   <port1> <port2> <bandwidth> <delay> <drop>
#
# Existing events are:
# down
# up
# reboot
# downinterface
# upinterface
END nodeinfo

LinkInfo: Describes each physical link in more detail.

START linkinfo
# Similar to nodeinfo.
# link <link>
# ...
# end
#
# Labels:
# src, dst, srcport, dstport - redundant with topology
END linkinfo

START assignment
# Information about how the mapping between physical and virtual
# seed <seed>
#
# seed is the random seed used by assign_hw.
END assignment

START vlan
# Records of the form:
# <vlan name> <mac1> <mac2> ... <macN>
# ...
#
# The contents are one vlan to each line.
# <vlan name> is usually the virtual link the vlan corresponds to.
END vlan

START events
# Records of the form:
# <offset in seconds (floating point)> <event> <arguments>
# Event types include:
#   link_down <link>
#   link_up <link>
#   power_cycle <node>
#   power_off <node>
#   power_on <node>
# Future events might include traffic control, routing changes, etc.
END events

START ip
START map
# Records of the form
# <node> <dst> <ip>
END map
START mac
# Records of the form
# <mac> <ip>
END mac
END ip

START delay
# Records of the form
# <node> <bw> <delay> <loss> <macA> <macB>
# <node> is a virtual node name, <bw> is in MB, and <delay> is in ms.
# <loss> is the loss rate between 0.0 and 1.0
# <macA> and <macB> are the macs to delay between
END delay

START os
START images
# Records of the form
# <label> <path> <partition>
# These are the entries made to the disk_images table by create-os commands
END images
START nodes
# Records of the form
# <node> <label>
# One entry for every <node>.  What image they should boot.
# <node> is a physical node and includes dnard number for dnards.
END nodes
END os

START cmdline
<node> <cmdline>
END cmdline

START rpms
<node> <rpms>
END rpms

START startup
<node> <runcmd>
END runcmd

