Stuff I did to make a node image for University of Kentucky.
Much of this overlaps with local image creation (see newimage.txt).

Start with one of our freshly loaded images.

A. FreeBSD (while running single user):

* Make sure local filesystems are mounted:
  mount -at ufs

* /root/.cvsup/auth
  Customize host/domain, leave password alone?

* /root/.ssh
  Remove known_hosts if it exists.  Put in local boss root pub key.
  Leave in our pub key if acceptible.

* /etc/localtime
  Copy the correct file over from /usr/share/zoneinfo

* /etc/motd
  Reflect new site

* /etc/rc.conf
  set ntpdate_flags to boss.uky.emulab.net

* /etc/ntp.conf
  Put in IP of time server

* /etc/testbed/master.passwd
  Change the root password, this file will get installed by prepare.

* /etc/ssh/ssh_host*
  Generate new host keys.  Actually, copy from an existing image.

* /etc/testbed/{client,emulab}.pem
  Generate a new one.

* /etc/testbed/supfile
  Fix release tag (FBSD*) if necessary and host=
  [ DON'T FORGET TO FIX UP cvsup TREE on boss ]

* /etc/testbed/sup/sup/*/checkouts
  Remove the files?

* /etc/testbed/tmcc
  Install a binary customized for the site.  Created as part of the
  general testbed software build.  Note: a "generic" tmcc would work,
  but ours has "boss.emulab.net" hardwired in.

* /usr/site
  Remove it.

* Run /etc/testbed/prepare
  This will install clean passwd and group files, clean out log files
  and take care of various other lint.

* Unmount filesystems, and remount root read-only to be safe:
  umount -at ufs
  mount -u -o ro /


B. While running Linux (single user):

* /root/.cvsup/auth
  Customize host/domain, leave password alone?

* /root/.ssh
  Remove known_hosts if it exists.  Put in local boss root pub key.
  Leave in our pub key if acceptible.

* /etc/localtime
  Copy the correct file over from /usr/share/zoneinfo

* /etc/ntp/step-tickers /etc/ntp.conf
  Put in IP of time server.

* /etc/ssh/ssh_host*
  Generate new host keys.  Actually, copy from an existing image.

* /etc/testbed/shadow
  Change the root password, this file will get installed by prepare.

* /etc/testbed/{client,emulab}.pem
  Generate a new one.

* /etc/testbed/supfile
  Fix release tag (RHL*) if necessary and host=

* /etc/testbed/sup/sup/*/checkouts
  Remove the files?

* /etc/testbed/tmcc
  Install a binary customized for the site.  Must be built from testbed
  source under Linux (duh!)  Note: a "generic" tmcc would work,
  but ours has "boss.emulab.net" hardwired in.

* /usr/site
  Remove it.

* Remount root filesystem read-only (IMPORTANT!)
  mount -o remount,ro /

D. Frisbee MFS (boss:/tftpboot/frisbee/boot/mfsroot):

E. FreeBSD MFS (boss:/tftpboot/boot/mfsroot):
