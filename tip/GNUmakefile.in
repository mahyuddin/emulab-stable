SRCDIR		= @srcdir@
TESTBED_SRCDIR	= @top_srcdir@
OBJDIR		= ..
SUBDIR		= tip

include $(OBJDIR)/Makeconf

all:	tip tiptunnel

include $(TESTBED_SRCDIR)/GNUmakerules

CC = gcc -g -O2 -DUSESOCKETS -DWITHSSL -I$(TESTBED_SRCDIR)/capture

OBJS = cmds.o cmdtab.o hunt.o partab.o \
       remote.o tip.o value.o vars.o getcap.o

TUNNELOBJS = tiptunnel.o

#
# If HAVE_UUCPLOCK is defined you need -lutil for BSD
#
LIBS=

SSLLIBS		= -lssl -lcrypto

tip:	$(OBJS)
	$(CC) -static -o tip $(OBJS) $(LIBS)

tiptunnel: tiptunnel.o
	$(CC) -o tiptunnel tiptunnel.o $(SSLLIBS) 

$(OBJS): tipconf.h tip.h

tiptunnel.o: tiptunnel.c $(TESTBED_SRCDIR)/capture/capdecls.h

control-install tipserv-install install:	all $(INSTALL_BINDIR)/tip $(INSTALL_BINDIR)/tiptunnel

clean:
	rm -f $(OBJS) tiptunnel.o tip tiptunnel
